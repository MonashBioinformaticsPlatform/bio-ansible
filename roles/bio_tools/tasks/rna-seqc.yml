---

- file:
    dest: "{{ source_dir }}/rna-seqc-{{ version }}"
    state: directory
    mode: 0755

  tags: get_rnaseqc 

- name: download RNA-SeQC
  get_url:
    url: "http://www.broadinstitute.org/cancer/cga/tools/rnaseqc/RNA-SeQC_v{{ version }}.jar"
    dest: "{{ source_dir }}/rna-seqc-{{ version }}"

  tags: get_rnaseqc 

- name: RNA-SeQC wrapper script
  template:
    src: java-wrapper.sh.j2
    dest: "{{ source_dir }}/rna-seqc-{{ version }}/rna-seqc"
    owner: "{{ main_guy }}" 
    mode: 0755
  with_items:
    - jar: "{{ source_dir }}/rna-seqc-{{ version }}/RNA-SeQC_v{{ version }}.jar"

  tags: build_rnaseqc 

- file:
    dest: "{{ modules_dir }}/rna-seqc"
    state: directory
    mode: 0755

  tags: lmod_rnaseqc 

- name: RNA-SeQC module definition
  template: 
    src: sw-module.lua.j2 
    dest: "{{ modules_dir }}/rna-seqc/{{ version }}.lua"
    owner: "{{ main_guy }}" 
    mode: 0644
  with_items:
    - help_text: 'RNA-SeQC is a java program which computes a series of quality control metrics for RNA-seq data'
      dir: 'rna-seqc-{{ version }}'
      skip_bin: true

  tags: lmod_rnaseqc 
