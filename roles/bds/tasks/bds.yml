---

- name: Downloading BigDataScript
  git: repo=https://github.com/pcingola/BigDataScript.git
       dest={{ source_dir }}/BigDataScript-{{ version }}
       version={{ version }}

- name: Installing BigDataScript
  shell: cd {{ source_dir }}/BigDataScript-{{version}}/; ./scripts/install.sh

- file: dest="{{ soft_dir }}/BigDataScript-{{version}}" state=directory mode=0755

- name: Movin bds directory to apps
  shell: mv "{{ local_home }}/.bds" "{{ soft_dir }}/BigDataScript-{{ version }}"
  args:
    creates: "{{ soft_dir }}/BigDataScript-{{ version }}/.bds/bds"

- file: dest={{ modules_dir }}/BigDataScript state=directory mode=0755

- name: BigDataScript module definition
  template: 
    src: sw-module.lua.j2 
    dest: "{{ modules_dir }}/BigDataScript/{{ version }}.lua"
    owner: "{{ main_guy }}" 
    mode: 0644
  with_items:
    - dir: 'BigDataScript-{{version}}/.bds'
      help_text: 'BigDataScript is intended as a scripting language for big data pipeline.'
      skip_bin: true

  tags: bds
